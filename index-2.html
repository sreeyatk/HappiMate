<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HappiMate: AI Mental Wellness Bot with Game-Based Therapy</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        :root {
            --primary-color: #6a11cb;
            --secondary-color: #2575fc;
            --success-color: #4CAF50;
            --warning-color: #ff9800;
            --danger-color: #f44336;
            --info-color: #2196F3;
        }

        body {
            background: linear-gradient(120deg, #f6f9fc 0%, #e9ecef 100%);
            min-height: 100vh;
        }

        .navbar {
            background: linear-gradient(to right, var(--primary-color), var(--secondary-color));
            box-shadow: 0 2px 15px rgba(0,0,0,0.1);
        }

        .chat-container {
            height: 500px;
            overflow-y: auto;
            border-radius: 15px;
            padding: 20px;
            background: white;
            box-shadow: 0 5px 15px rgba(0,0,0,0.08);
        }

        .games-sidebar {
            height: 500px;
            overflow-y: auto;
            background: white;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.08);
        }

        .game-container {
            height: 500px;
            background: white;
            border-radius: 15px;
            padding: 20px;
            display: none;
            box-shadow: 0 5px 15px rgba(0,0,0,0.08);
            position: relative;
            overflow: hidden;
        }

        .message {
            margin-bottom: 15px;
            padding: 12px 18px;
            border-radius: 15px;
            max-width: 80%;
            animation: fadeIn 0.3s ease-in;
        }

        .user-message {
            background: linear-gradient(to right, var(--primary-color), var(--secondary-color));
            color: white;
            margin-left: auto;
            box-shadow: 0 3px 10px rgba(106, 17, 203, 0.2);
        }

        .bot-message {
            background: #f8f9fa;
            color: #343a40;
            border-left: 4px solid var(--primary-color);
        }

        .game-button {
            display: block;
            margin: 8px 0;
            padding: 12px;
            background: white;
            color: var(--primary-color);
            border: 2px solid var(--primary-color);
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            text-align: left;
        }

        .game-button:hover {
            background: linear-gradient(to right, var(--primary-color), var(--secondary-color));
            color: white;
            transform: translateX(5px);
        }

        .game-button i {
            margin-right: 10px;
        }

        :root {
    --primary-color: #6a5acd;
    --secondary-color: #48c6ef;
}

.memory-card {
    width: 80px;
    height: 80px;
    margin: 10px;
    perspective: 1000px;
    cursor: pointer;
}

.card-inner {
    position: relative;
    width: 100%;
    height: 100%;
    transform-style: preserve-3d;
    transform: rotateY(0deg);
    transition: transform 0.6s;
}

.memory-card.flipped .card-inner {
    transform: rotateY(180deg);
}

.card-front,
.card-back {
    position: absolute;
    width: 100%;
    height: 100%;
    backface-visibility: hidden;
    display: flex;
    justify-content: center;
    align-items: center;
    font-size: 24px;
    border-radius: 10px;
    box-shadow: 0 3px 10px rgba(0, 0, 0, 0.2);
}

.card-front {
    background: linear-gradient(45deg, var(--primary-color), var(--secondary-color));
    color: #333;
}

.card-back {
    background: linear-gradient(45deg, var(--primary-color), var(--secondary-color));
    transform: rotateY(180deg);
    color: white;
    font-size: 28px;
}



        /* Word Scramble Styles */
        .word-scramble {
            text-align: center;
            padding: 20px;
        }

        .scrambled-word {
            font-size: 2em;
            color: var(--primary-color);
            margin: 20px 0;
            letter-spacing: 5px;
        }

        /* Color Match Styles */
        .color-match {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 10px;
            padding: 20px;
        }

        .color-tile {
            width: 100px;
            height: 100px;
            border-radius: 10px;
            cursor: pointer;
            transition: transform 0.3s;
        }

        .color-tile:hover {
            transform: scale(1.1);
        }

        /* Math Game Styles */
        .math-game {
            text-align: center;
            padding: 20px;
        }

        .math-problem {
            font-size: 2em;
            color: var(--primary-color);
            margin: 20px 0;
        }

        /* Pattern Memory Styles */
        .pattern-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            margin: 20px auto;
            max-width: 300px;
        }

        .pattern-cell {
            aspect-ratio: 1;
            border-radius: 8px;
            background: #e9ecef;
            cursor: pointer;
            transition: background-color 0.3s;
        }

        .pattern-cell.active {
            background: var(--primary-color);
        }

        /* Reaction Time Styles */
        .reaction-target {
            width: 100px;
            height: 100px;
            border-radius: 50%;
            background: var(--danger-color);
            position: absolute;
            cursor: pointer;
            transition: all 0.3s;
        }

        /* Breathing Exercise Styles */
        .breathing-circle {
            width: 200px;
            height: 200px;
            border-radius: 50%;
            background: linear-gradient(45deg, var(--primary-color), var(--secondary-color));
            margin: 20px auto;
            animation: breathe 8s infinite;
            display: flex;
            justify-content: center;
            align-items: center;
            color: white;
            box-shadow: 0 0 30px rgba(37, 117, 252, 0.3);
        }

        /* Word Chain Styles */
        .word-chain {
            text-align: center;
            padding: 20px;
        }

        .last-word {
            font-size: 2em;
            color: var(--primary-color);
            margin: 20px 0;
        }

        @keyframes breathe {
            0%, 100% { transform: scale(1); box-shadow: 0 0 30px rgba(37, 117, 252, 0.3); }
            50% { transform: scale(1.5); box-shadow: 0 0 50px rgba(37, 117, 252, 0.5); }
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .input-group {
            box-shadow: 0 3px 10px rgba(0,0,0,0.1);
            border-radius: 10px;
            overflow: hidden;
        }

        .input-group input {
            border: none;
            padding: 15px;
        }

        .input-group button {
            background: linear-gradient(to right, var(--primary-color), var(--secondary-color));
            border: none;
            color: white;
            padding: 15px 25px;
        }

        .category-header {
            color: var(--primary-color);
            margin: 20px 0 10px;
            font-size: 1.2em;
            border-bottom: 2px solid var(--secondary-color);
            padding-bottom: 5px;
        }
    </style>
</head>
<body>
    <nav class="navbar navbar-expand-lg navbar-dark mb-4">
        <div class="container">
            <a class="navbar-brand" href="#">
                <i class="fas fa-brain me-2"></i>
                HappiMate
            </a>
        </div>
    </nav>

    <div class="container">
        <div class="row">
            <div class="col-md-3">
                <div class="games-sidebar">
                    <h4 class="mb-4">Available Games</h4>
                    
                    <h5 class="category-header">Focus & Memory</h5>
                    <a href="#" class="game-button" onclick="selectGame('memory')">
                        <i class="fas fa-chess-board"></i> Memory Cards
                    </a>
                    <a href="#" class="game-button" onclick="selectGame('pattern')">
                        <i class="fas fa-th"></i> Pattern Memory
                    </a>
                    <a href="#" class="game-button" onclick="selectGame('sequence')">
                        <i class="fas fa-list-ol"></i> Number Sequence
                    </a>

                    <h5 class="category-header">Relaxation</h5>
                    <a href="#" class="game-button" onclick="selectGame('breathing')">
                        <i class="fas fa-wind"></i> Breathing Exercise
                    </a>
                    <a href="#" class="game-button" onclick="selectGame('coloring')">
                        <i class="fas fa-paint-brush"></i> Color Therapy
                    </a>
                    <a href="#" class="game-button" onclick="selectGame('meditation')">
                        <i class="fas fa-om"></i> Guided Meditation
                    </a>

                    <h5 class="category-header">Problem Solving</h5>
                    <a href="#" class="game-button" onclick="selectGame('wordscramble')">
                        <i class="fas fa-font"></i> Word Scramble
                    </a>
                    <a href="#" class="game-button" onclick="selectGame('math')">
                        <i class="fas fa-calculator"></i> Math Challenge
                    </a>
                    <a href="#" class="game-button" onclick="selectGame('puzzle')">
                        <i class="fas fa-puzzle-piece"></i> Picture Puzzle
                    </a>

                    <h5 class="category-header">Quick Games</h5>
                    <a href="#" class="game-button" onclick="selectGame('reaction')">
                        <i class="fas fa-bolt"></i> Reaction Time
                    </a>
                    <a href="#" class="game-button" onclick="selectGame('colormatch')">
                        <i class="fas fa-palette"></i> Color Match
                    </a>
                    <a href="#" class="game-button" onclick="selectGame('wordchain')">
                        <i class="fas fa-link"></i> Word Chain
                    </a>
                </div>
            </div>
            
            <div class="col-md-5">
                <div class="chat-container" id="chatContainer"></div>
                <div class="input-group mt-3">
                    <input type="text" class="form-control" id="userInput" placeholder="Type your message...">
                    <button class="btn btn-primary" onclick="sendMessage()">Send</button>
                </div>
            </div>

            <div class="col-md-4">
                <div class="game-container" id="gameContainer">
                    <!-- Games will be loaded here -->
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>




        // Game implementations will go here
        let currentGame = null;
        let conversationState = 'initial';

        function selectGame(gameType) {
    const gameContainer = document.getElementById('gameContainer');
    gameContainer.style.display = 'block';
    
    // Clear any existing intervals or timers
    if (currentGame) {
        clearInterval(currentGame);
    }
    
    switch(gameType) {
        case 'memory':
            startMemoryGame();
            break;
        case 'pattern':
            startPatternMemory();
            break;
        case 'sequence':
            startSequenceGame();
            break;
        case 'breathing':
            startBreathingExercise();
            break;
        case 'coloring':
            startColoringGame();
            break;
        case 'meditation':
            startMeditationGame();
            break;
        case 'wordscramble':
            startWordScramble();
            break;
        case 'math':
            startMathGame();
            break;
        case 'puzzle':
            startPuzzleGame();
            break;
        case 'reaction':
            startReactionGame();
            break;
        case 'colormatch':
            startColorMatch();
            break;
        case 'wordchain':
            startWordChain();
            break;
    }
    
    addMessage(`Great choice! I've started the ${gameType.replace(/([A-Z])/g, ' $1').toLowerCase()} game for you. Give it a try!`, 'bot');
}
        // Add this code after your existing JavaScript

        function startSequenceGame() {
    const gameContainer = document.getElementById('gameContainer');
    gameContainer.innerHTML = `
        <div class="text-center">
            <h3 class="mb-4">Number Sequence</h3>
            <div id="sequenceDisplay" class="mb-3" style="font-size: 2em;"></div>
            <div class="input-group mb-3">
                <input type="number" class="form-control" id="sequenceGuess" placeholder="What comes next?">
                <button class="btn btn-primary" onclick="checkSequence()">Submit</button>
            </div>
            <div class="mt-3">Score: <span id="sequenceScore">0</span></div>
        </div>
    `;
    
    generateSequence();
}

let currentSequence = [];
let sequenceScore = 0;

function generateSequence() {
    const types = ['arithmetic', 'geometric', 'fibonacci'];
    const type = types[Math.floor(Math.random() * types.length)];
    currentSequence = [];
    
    switch(type) {
        case 'arithmetic':
            const diff = Math.floor(Math.random() * 5) + 1;
            const start = Math.floor(Math.random() * 10);
            for(let i = 0; i < 4; i++) {
                currentSequence.push(start + (diff * i));
            }
            currentSequence.push(start + (diff * 4)); // Answer
            break;
            
        case 'geometric':
            const ratio = Math.floor(Math.random() * 2) + 2;
            const gStart = Math.floor(Math.random() * 5) + 1;
            for(let i = 0; i < 4; i++) {
                currentSequence.push(gStart * Math.pow(ratio, i));
            }
            currentSequence.push(gStart * Math.pow(ratio, 4)); // Answer
            break;
            
        case 'fibonacci':
            const f1 = Math.floor(Math.random() * 5) + 1;
            const f2 = Math.floor(Math.random() * 5) + f1;
            currentSequence = [f1, f2];
            for(let i = 2; i < 5; i++) {
                currentSequence.push(currentSequence[i-1] + currentSequence[i-2]);
            }
            break;
    }
    
    document.getElementById('sequenceDisplay').textContent = 
        currentSequence.slice(0, 4).join(', ') + ', ?';
}

function checkSequence() {
    const guess = parseInt(document.getElementById('sequenceGuess').value);
    if(guess === currentSequence[4]) {
        sequenceScore += 10;
        document.getElementById('sequenceScore').textContent = sequenceScore;
        document.getElementById('sequenceGuess').value = '';
        generateSequence();
    } else {
        alert('Try again!');
    }
}

// Coloring Game Implementation
function startColoringGame() {
    const gameContainer = document.getElementById('gameContainer');
    gameContainer.innerHTML = `
        <div class="text-center">
            <h3 class="mb-4">Color Therapy</h3>
            <div class="canvas-container">
                <canvas id="coloringCanvas" width="400" height="400" 
                    style="border: 1px solid #ccc;"></canvas>
            </div>
            <div class="color-palette mt-3"></div>
            <button class="btn btn-secondary mt-3" onclick="clearCanvas()">Clear Canvas</button>
        </div>
    `;
    
    setupColoringGame();
}

function setupColoringGame() {
    const canvas = document.getElementById('coloringCanvas');
    const ctx = canvas.getContext('2d');
    let isDrawing = false;
    let currentColor = '#000000';
    
    // Create color palette
    const colors = ['#000000', '#FF0000', '#00FF00', '#0000FF', '#FFFF00', '#FF00FF', '#00FFFF'];
    const palette = document.querySelector('.color-palette');
    colors.forEach(color => {
        const colorButton = document.createElement('button');
        colorButton.style.backgroundColor = color;
        colorButton.style.width = '30px';
        colorButton.style.height = '30px';
        colorButton.style.margin = '0 5px';
        colorButton.style.border = '1px solid #ccc';
        colorButton.onclick = () => currentColor = color;
        palette.appendChild(colorButton);
    });
    
    // Drawing functionality
    canvas.onmousedown = (e) => {
        isDrawing = true;
        draw(e);
    };
    canvas.onmousemove = draw;
    canvas.onmouseup = () => isDrawing = false;
    canvas.onmouseout = () => isDrawing = false;
    
    function draw(e) {
        if (!isDrawing) return;
        const rect = canvas.getBoundingClientRect();
        const x = e.clientX - rect.left;
        const y = e.clientY - rect.top;
        
        ctx.fillStyle = currentColor;
        ctx.beginPath();
        ctx.arc(x, y, 5, 0, Math.PI * 2);
        ctx.fill();
    }
}

function clearCanvas() {
    const canvas = document.getElementById('coloringCanvas');
    const ctx = canvas.getContext('2d');
    ctx.clearRect(0, 0, canvas.width, canvas.height);
}

// Meditation Game Implementation
function startMeditationGame() {
    const gameContainer = document.getElementById('gameContainer');
    gameContainer.innerHTML = `
        <div class="text-center">
            <h3 class="mb-4">Guided Meditation</h3>
            <div class="breathing-circle mb-4">
                <div id="meditationText">Focus on your breath</div>
            </div>
            <div class="timer mb-3">Time: <span id="meditationTimer">5:00</span></div>
            <button class="btn btn-primary" id="startMeditation">Start Session</button>
        </div>
    `;
    
    setupMeditation();
}

function setupMeditation() {
    let timeLeft = 300; // 5 minutes
    let isActive = false;
    let interval;
    const prompts = [
        "Focus on your breath",
        "Notice any tension in your body",
        "Let your thoughts pass by",
        "Feel the weight of your body",
        "Bring awareness to your surroundings"
    ];
    
    document.getElementById('startMeditation').onclick = () => {
        if (!isActive) {
            isActive = true;
            document.getElementById('startMeditation').textContent = 'Stop Session';
            startMeditationTimer();
        } else {
            isActive = false;
            clearInterval(interval);
            document.getElementById('startMeditation').textContent = 'Start Session';
            timeLeft = 300;
            updateMeditationTimer();
        }
    };
    
    function startMeditationTimer() {
        interval = setInterval(() => {
            timeLeft--;
            updateMeditationTimer();
            
            if (timeLeft % 60 === 0) {
                document.getElementById('meditationText').textContent = 
                    prompts[Math.floor(Math.random() * prompts.length)];
            }
            
            if (timeLeft <= 0) {
                clearInterval(interval);
                isActive = false;
                document.getElementById('startMeditation').textContent = 'Start Session';
                alert('Meditation session completed!');
            }
        }, 1000);
    }
    
    function updateMeditationTimer() {
        const minutes = Math.floor(timeLeft / 60);
        const seconds = timeLeft % 60;
        document.getElementById('meditationTimer').textContent = 
            `${minutes}:${seconds.toString().padStart(2, '0')}`;
    }
}

// Picture Puzzle Implementation
function startPuzzleGame() {
    const gameContainer = document.getElementById('gameContainer');
    gameContainer.innerHTML = `
        <div class="text-center">
            <h3 class="mb-4">Picture Puzzle</h3>
            <div id="puzzleGrid" class="d-flex flex-wrap justify-content-center" 
                style="width: 300px; margin: 0 auto;"></div>
            <button class="btn btn-primary mt-3" onclick="shufflePuzzle()">Shuffle</button>
        </div>
    `;
    
    setupPuzzle();
}

let puzzleState = [];
const puzzleSize = 3;

function setupPuzzle() {
    const grid = document.getElementById('puzzleGrid');
    grid.innerHTML = ''; // Clear the grid before repopulating

    puzzleState.forEach((num, index) => {
        const tile = document.createElement('div');
        tile.style.width = '98px';
        tile.style.height = '98px';
        tile.style.border = '1px solid #ccc';
        tile.style.display = 'flex';
        tile.style.justifyContent = 'center';
        tile.style.alignItems = 'center';
        tile.style.fontSize = '2em';
        tile.style.cursor = 'pointer';
        tile.style.margin = '1px';
        
        if (num !== null) {
            tile.textContent = num;
            tile.style.backgroundColor = '#fff';
        }
        
        tile.onclick = () => movePuzzleTile(index);
        grid.appendChild(tile);
    });
}

function movePuzzleTile(index) {
    const emptyIndex = puzzleState.indexOf(null);
    const row = Math.floor(index / puzzleSize);
    const emptyRow = Math.floor(emptyIndex / puzzleSize);
    const col = index % puzzleSize;
    const emptyCol = emptyIndex % puzzleSize;
    
    if ((Math.abs(row - emptyRow) === 1 && col === emptyCol) ||
        (Math.abs(col - emptyCol) === 1 && row === emptyRow)) {
        puzzleState[emptyIndex] = puzzleState[index];
        puzzleState[index] = null;
        setupPuzzle(); // Update puzzle state after moving
        checkPuzzleWin();
    }
}

function shufflePuzzle() {
    // Shuffle logic
    const originalState = [...Array(puzzleSize * puzzleSize - 1).keys()].map(x => x + 1);
    originalState.push(null); // Empty space

    // Ensure we start with a valid shuffled state
    let shuffled = [...originalState];
    for (let i = shuffled.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]]; // Swap
    }

    puzzleState = shuffled; // Update the puzzle state with the shuffled array

    setupPuzzle(); // Update the grid with shuffled state
}

function checkPuzzleWin() {
    const solution = [...Array(puzzleSize * puzzleSize - 1).keys()].map(x => x + 1);
    solution.push(null);
    
    if (puzzleState.every((num, index) => num === solution[index])) {
        alert('Congratulations! You solved the puzzle!');
    }
}

// Start the game when needed
startPuzzleGame();


function startWordChain() {
    const gameContainer = document.getElementById('gameContainer');
    gameContainer.innerHTML = `
        <div class="text-center">
            <h3 class="mb-4">Word Chain</h3>
            <div class="last-word mb-3">Last Word: <span id="currentWord">START</span></div>
            <div class="input-group mb-3">
                <input type="text" class="form-control" id="wordInput" 
                    placeholder="Enter a word that starts with the last letter" />
                <button class="btn btn-primary" onclick="submitWord()">Submit</button>
            </div>
            <div class="mt-3">Score: <span id="chainScore">0</span></div>
        </div>
    `;

    chainScore = 0; // Reset score
    usedWords = new Set(['START']); // Reset used words
    document.getElementById('wordInput').focus(); // Focus on the input field
}

let chainScore = 0;
let usedWords = new Set(['START']);

function submitWord() {
    const input = document.getElementById('wordInput');
    const newWord = input.value.trim().toUpperCase(); // Convert input to uppercase
    const currentWord = document.getElementById('currentWord').textContent;

    if (newWord.length < 2) {
        alert('Word must be at least 2 letters long!');
        return;
    }

    if (usedWords.has(newWord)) {
        alert('Word already used!');
        return;
    }

    if (newWord[0] !== currentWord[currentWord.length - 1]) {
        alert('Word must start with the last letter of the previous word!');
        return;
    }

    // Valid word, update the game state
    usedWords.add(newWord);
    document.getElementById('currentWord').textContent = newWord;
    chainScore += newWord.length; // Add word length to score
    document.getElementById('chainScore').textContent = chainScore;

    input.value = ''; // Clear the input field
    input.focus(); // Refocus the input field
}


// Memory Game Implementation
let flippedCards = [];
let matchedPairs = 0;

function startMemoryGame() {
    const gameContainer = document.getElementById('gameContainer');
    gameContainer.innerHTML = `
        <h3 class="text-center mb-4">Memory Game</h3>
        <div class="d-flex flex-wrap justify-content-center" id="memoryBoard"></div>
        <div class="text-center mt-4">
            <button class="btn btn-primary" onclick="resetMemoryGame()">New Game</button>
        </div>
    `;

    const emojis = ['ðŸŒŸ', 'ðŸŽˆ', 'ðŸŒº', 'ðŸŒ¸', 'ðŸ€', 'ðŸŒˆ'];
    const cardPairs = [...emojis, ...emojis];
    matchedPairs = 0;
    flippedCards = [];

    // Shuffle cards
    const shuffledCards = cardPairs.sort(() => Math.random() - 0.5);

    const board = document.getElementById('memoryBoard');
    shuffledCards.forEach((emoji, index) => {
        const card = document.createElement('div');
        card.className = 'memory-card';
        card.innerHTML = `
            <div class="card-inner">
                <div class="card-front">?</div>
                <div class="card-back">${emoji}</div>
            </div>
        `;
        card.dataset.emoji = emoji;
        card.addEventListener('click', () => flipCard(card));
        board.appendChild(card);
    });
}

function flipCard(card) {
    if (card.classList.contains('flipped') || flippedCards.length === 2) return;

    card.classList.add('flipped');
    flippedCards.push(card);

    if (flippedCards.length === 2) {
        const [firstCard, secondCard] = flippedCards;

        // Check for a match
        if (firstCard.dataset.emoji === secondCard.dataset.emoji) {
            matchedPairs++;
            flippedCards = [];
            if (matchedPairs === 8) {
                setTimeout(() => {
                    alert('ðŸŽ‰ Congratulations! You won!');
                    resetMemoryGame();
                }, 500);
            }
        } else {
            setTimeout(() => {
                firstCard.classList.remove('flipped');
                secondCard.classList.remove('flipped');
                flippedCards = [];
            }, 1000);
        }
    }
}

function resetMemoryGame() {
    startMemoryGame();
}

// Breathing Exercise Implementation
function startBreathingExercise() {
    const gameContainer = document.getElementById('gameContainer');
    gameContainer.innerHTML = `
        <h3 class="text-center mb-4">Breathing Exercise</h3>
        <div class="breathing-circle" id="breathingCircle">
            <div id="breathingText">Breathe In</div>
        </div>
        <div class="text-center mt-4">
            <button class="btn btn-primary" id="startBreathing">Start</button>
        </div>
    `;

    let isBreathing = false;
    const breathingText = document.getElementById('breathingText');
    const startButton = document.getElementById('startBreathing');
    
    startButton.addEventListener('click', () => {
        if (!isBreathing) {
            isBreathing = true;
            startButton.textContent = 'Stop';
            startBreathingCycle();
        } else {
            isBreathing = false;
            startButton.textContent = 'Start';
            breathingText.textContent = 'Breathe In';
        }
    });
}

function startBreathingCycle() {
    const breathingText = document.getElementById('breathingText');
    const startButton = document.getElementById('startBreathing');
    
    let count = 0;
    const interval = setInterval(() => {
        if (startButton.textContent === 'Start') {
            clearInterval(interval);
            return;
        }
        
        count = (count + 1) % 3;
        switch(count) {
            case 0:
                breathingText.textContent = 'Breathe In';
                break;
            case 1:
                breathingText.textContent = 'Hold';
                break;
            case 2:
                breathingText.textContent = 'Breathe Out';
                break;
        }
    }, 4000);
}

// Word Scramble Implementation
function startWordScramble() {
    const words = ['PEACE', 'CALM', 'RELAX', 'MINDFUL', 'SERENITY', 'BALANCE'];
    let currentWord = words[Math.floor(Math.random() * words.length)];
    let scrambledWord = scrambleWord(currentWord);

    const gameContainer = document.getElementById('gameContainer');
    gameContainer.innerHTML = `
        <div class="word-scramble">
            <h3 class="mb-4">Word Scramble</h3>
            <p class="scrambled-word">${scrambledWord}</p>
            <div class="input-group mb-3">
                <input type="text" class="form-control" id="wordGuess" placeholder="Enter your guess">
                <button class="btn btn-primary" onclick="checkWord()">Check</button>
            </div>
            <button class="btn btn-secondary" onclick="newWord()">New Word</button>
        </div>
    `;

    gameContainer.dataset.currentWord = currentWord;
}

function scrambleWord(word) {
    return word.split('').sort(() => Math.random() - 0.5).join('');
}

function checkWord() {
    const input = document.getElementById('wordGuess');
    const guess = input.value.toUpperCase();
    const currentWord = document.getElementById('gameContainer').dataset.currentWord;

    if (guess === currentWord) {
        alert('Correct! Well done!');
        newWord();
    } else {
        alert('Try again!');
    }
    input.value = '';
}

function newWord() {
    startWordScramble();
}

// Pattern Memory Implementation
function startPatternMemory() {
    const gameContainer = document.getElementById('gameContainer');
    gameContainer.innerHTML = `
        <h3 class="text-center mb-4">Pattern Memory</h3>
        <div class="pattern-grid" id="patternGrid"></div>
        <div class="text-center mt-4">
            <button class="btn btn-primary" onclick="startPattern()">Start New Pattern</button>
        </div>
    `;

    const grid = document.getElementById('patternGrid');
    for (let i = 0; i < 9; i++) {
        const cell = document.createElement('div');
        cell.className = 'pattern-cell';
        cell.dataset.index = i;
        grid.appendChild(cell);
    }
}

let pattern = [];
let playerPattern = [];
let isShowingPattern = false;

function startPattern() {
    if (isShowingPattern) return;
    pattern = [];
    playerPattern = [];
    for (let i = 0; i < 4; i++) {
        pattern.push(Math.floor(Math.random() * 9));
    }
    showPattern();
}

function showPattern() {
    isShowingPattern = true;
    let index = 0;
    const cells = document.querySelectorAll('.pattern-cell');
    
    const interval = setInterval(() => {
        cells.forEach(cell => cell.classList.remove('active'));
        if (index < pattern.length) {
            cells[pattern[index]].classList.add('active');
            index++;
        } else {
            clearInterval(interval);
            setTimeout(() => {
                cells.forEach(cell => cell.classList.remove('active'));
                isShowingPattern = false;
                setupPlayerTurn();
            }, 500);
        }
    }, 1000);
}

function setupPlayerTurn() {
    const cells = document.querySelectorAll('.pattern-cell');
    cells.forEach(cell => {
        cell.addEventListener('click', handleCellClick);
    });
}

function handleCellClick(event) {
    if (isShowingPattern) return;
    
    const index = parseInt(event.target.dataset.index);
    playerPattern.push(index);
    event.target.classList.add('active');
    
    setTimeout(() => {
        event.target.classList.remove('active');
    }, 300);

    if (playerPattern[playerPattern.length - 1] !== pattern[playerPattern.length - 1]) {
        alert('Wrong pattern! Try again.');
        playerPattern = [];
        setTimeout(showPattern, 1000);
        return;
    }

    if (playerPattern.length === pattern.length) {
        alert('Correct! Well done!');
        playerPattern = [];
        pattern = [];
        setTimeout(startPattern, 1000);
    }
}

// Add event listeners once DOM is loaded
document.addEventListener('DOMContentLoaded', () => {
    // Initialize any necessary game states
    startMemoryGame();
});

        function addMessage(message, sender) {
            const chatContainer = document.getElementById('chatContainer');
            const messageDiv = document.createElement('div');
            messageDiv.classList.add('message', sender === 'user' ? 'user-message' : 'bot-message');
            messageDiv.textContent = message;
            chatContainer.appendChild(messageDiv);
            chatContainer.scrollTop = chatContainer.scrollHeight;
        }

        function sendMessage() {
            const input = document.getElementById('userInput');
            const message = input.value.trim();
            if (message === '') return;

            addMessage(message, 'user');
            input.value = '';
            processMessage(message);
        }

        // Initial greeting
        setTimeout(() => {
            addMessage("Hello! I'm your mental wellness companion. I'm here to chat and help you explore our collection of therapeutic games. What would you like to try first?", 'bot');
        }, 1000);

        // Enter key support
        document.getElementById('userInput').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                sendMessage();
            }
        });
        function processMessage(message) {
            const lowercaseMessage = message.toLowerCase();
            
            setTimeout(() => {
                if (lowercaseMessage.includes('game') || lowercaseMessage.includes('play')) {
                    addMessage("Which game would you like to try?", 'bot', true);
                    conversationState = 'game_selection';
                }
                else if (lowercaseMessage.includes('memory') || lowercaseMessage.includes('1')) {
                    selectGame('memory');
                }
                else if (lowercaseMessage.includes('breathing') || lowercaseMessage.includes('2')) {
                    selectGame('breathing');
                }
                else if (lowercaseMessage.includes('anxiety') || lowercaseMessage.includes('stress')) {
                    addMessage("I hear that you're feeling anxious. Would you like to try our breathing exercise? It can help calm your mind.", 'bot', true);
                }
                else if (conversationState === 'initial') {
                    addMessage("I'm here to support you. Would you like to talk about how you're feeling or try one of our relaxation games?", 'bot');
                    conversationState = 'engaged';
                }
                else {
                    addMessage("I'm here to listen and help. Would you like to try one of our therapeutic games?", 'bot', true);
                }
            }, 1000);
        }
        // Math Challenge Implementation
function startMathGame() {
    const gameContainer = document.getElementById('gameContainer');
    gameContainer.innerHTML = `
        <div class="math-game">
            <h3 class="mb-4">Math Challenge</h3>
            <div class="math-problem" id="mathProblem"></div>
            <div class="input-group mb-3">
                <input type="number" class="form-control" id="mathAnswer" placeholder="Enter your answer">
                <button class="btn btn-primary" onclick="checkMathAnswer()">Submit</button>
            </div>
            <div class="mt-3">
                <span class="me-3">Score: <span id="mathScore">0</span></span>
                <span>Time: <span id="mathTimer">60</span>s</span>
            </div>
        </div>
    `;

    generateMathProblem();
    startMathTimer();
}

let mathScore = 0;
let currentAnswer = 0;

function generateMathProblem() {
    const num1 = Math.floor(Math.random() * 20) + 1;
    const num2 = Math.floor(Math.random() * 20) + 1;
    const operations = ['+', '-', '*'];
    const operation = operations[Math.floor(Math.random() * operations.length)];
    
    const problemElement = document.getElementById('mathProblem');
    problemElement.textContent = `${num1} ${operation} ${num2} = ?`;
    
    switch(operation) {
        case '+': currentAnswer = num1 + num2; break;
        case '-': currentAnswer = num1 - num2; break;
        case '*': currentAnswer = num1 * num2; break;
    }
}

function checkMathAnswer() {
    const userAnswer = parseInt(document.getElementById('mathAnswer').value);
    if (userAnswer === currentAnswer) {
        mathScore += 10;
        document.getElementById('mathScore').textContent = mathScore;
        document.getElementById('mathAnswer').value = '';
        generateMathProblem();
    } else {
        alert('Try again!');
    }
}

function startMathTimer() {
    let timeLeft = 60;
    const timerElement = document.getElementById('mathTimer');
    
    const timer = setInterval(() => {
        timeLeft--;
        timerElement.textContent = timeLeft;
        
        if (timeLeft <= 0) {
            clearInterval(timer);
            alert(`Time's up! Final score: ${mathScore}`);
            mathScore = 0;
            startMathGame();
        }
    }, 1000);
}

// Color Match Implementation
function startColorMatch() {
    const gameContainer = document.getElementById('gameContainer');
    gameContainer.innerHTML = `
        <div class="text-center">
            <h3 class="mb-4">Color Match</h3>
            <div class="target-color mb-3">
                Match this color: <div id="targetColor" class="d-inline-block mx-2" style="width: 50px; height: 25px; border: 1px solid black;"></div>
            </div>
            <div class="color-match" id="colorGrid"></div>
            <div class="mt-3">Score: <span id="colorScore">0</span></div>
        </div>
    `;

    generateColorMatch();
}

let colorMatchScore = 0;

function generateColorMatch() {
    const colors = ['#FF0000', '#00FF00', '#0000FF', '#FFFF00', '#FF00FF', '#00FFFF'];
    const targetColor = colors[Math.floor(Math.random() * colors.length)];
    document.getElementById('targetColor').style.backgroundColor = targetColor;
    
    const grid = document.getElementById('colorGrid');
    grid.innerHTML = '';
    
    // Shuffle colors and create tiles
    const shuffledColors = [...colors].sort(() => Math.random() - 0.5);
    shuffledColors.forEach(color => {
        const tile = document.createElement('div');
        tile.className = 'color-tile';
        tile.style.backgroundColor = color;
        tile.onclick = () => checkColorMatch(color, targetColor);
        grid.appendChild(tile);
    });
}

function checkColorMatch(selectedColor, targetColor) {
    if (selectedColor === targetColor) {
        colorMatchScore += 10;
        document.getElementById('colorScore').textContent = colorMatchScore;
        generateColorMatch();
    } else {
        alert('Try again!');
    }
}

// Reaction Time Game Implementation
function startReactionGame() {
    const gameContainer = document.getElementById('gameContainer');
    gameContainer.innerHTML = `
        <div class="text-center">
            <h3 class="mb-4">Reaction Time</h3>
            <div id="reactionTarget" class="reaction-target"></div>
            <div class="mt-3">Best Time: <span id="bestTime">---</span> ms</div>
        </div>
    `;

    setupReactionGame();
}

let startTime;
let bestReactionTime = Infinity;

function setupReactionGame() {
    const target = document.getElementById('reactionTarget');
    target.style.backgroundColor = '#f44336';
    target.style.left = Math.random() * (gameContainer.offsetWidth - 100) + 'px';
    target.style.top = Math.random() * (gameContainer.offsetHeight - 100) + 'px';
    
    setTimeout(() => {
        target.style.backgroundColor = '#4CAF50';
        startTime = Date.now();
        target.onclick = () => {
            const reactionTime = Date.now() - startTime;
            bestReactionTime = Math.min(bestReactionTime, reactionTime);
            document.getElementById('bestTime').textContent = bestReactionTime;
            setupReactionGame();
        };
    }, Math.random() * 3000 + 1000);
}

    </script>
</body>
</html>
<!-- problem solving ,quickgames and relaxation games are not working -->
